function t(t,e,i,s){var o,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(n<3?o(r):n>3?o(e,i,r):o(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}const e=window,i=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,i){if(this._$cssResult$=!0,i!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(i&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=o.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&o.set(e,t))}return t}toString(){return this.cssText}}const r=(t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,s)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+t[s+1]),t[0]);return new n(i,t,s)},a=i?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const i of t.cssRules)e+=i.cssText;return(t=>new n("string"==typeof t?t:t+"",void 0,s))(e)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var l;const h=window,d=h.trustedTypes,c=d?d.emptyScript:"",u=h.reactiveElementPolyfillSupport,p={toAttribute(t,e){switch(e){case Boolean:t=t?c:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},g=(t,e)=>e!==t&&(e==e||t==t),v={attribute:!0,type:String,converter:p,reflect:!1,hasChanged:g};class _ extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,i)=>{const s=this._$Ep(i,e);void 0!==s&&(this._$Ev.set(s,i),t.push(s))})),t}static createProperty(t,e=v){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const i="symbol"==typeof t?Symbol():"__"+t,s=this.getPropertyDescriptor(t,i,e);void 0!==s&&Object.defineProperty(this.prototype,t,s)}}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(s){const o=this[t];this[e]=s,this.requestUpdate(t,o,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||v}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const i of e)this.createProperty(i,t[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Ep(t,e){const i=e.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,i;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(i=t.hostConnected)||void 0===i||i.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const s=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,s)=>{i?t.adoptedStyleSheets=s.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):s.forEach((i=>{const s=document.createElement("style"),o=e.litNonce;void 0!==o&&s.setAttribute("nonce",o),s.textContent=i.cssText,t.appendChild(s)}))})(s,this.constructor.elementStyles),s}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EO(t,e,i=v){var s;const o=this.constructor._$Ep(t,i);if(void 0!==o&&!0===i.reflect){const n=(void 0!==(null===(s=i.converter)||void 0===s?void 0:s.toAttribute)?i.converter:p).toAttribute(e,i.type);this._$El=t,null==n?this.removeAttribute(o):this.setAttribute(o,n),this._$El=null}}_$AK(t,e){var i;const s=this.constructor,o=s._$Ev.get(t);if(void 0!==o&&this._$El!==o){const t=s.getPropertyOptions(o),n="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(i=t.converter)||void 0===i?void 0:i.fromAttribute)?t.converter:p;this._$El=o,this[o]=n.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,i){let s=!0;void 0!==t&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||g)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,i))):s=!1),!this.isUpdatePending&&s&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var m;_.finalized=!0,_.elementProperties=new Map,_.elementStyles=[],_.shadowRootOptions={mode:"open"},null==u||u({ReactiveElement:_}),(null!==(l=h.reactiveElementVersions)&&void 0!==l?l:h.reactiveElementVersions=[]).push("1.5.0");const f=window,y=f.trustedTypes,b=y?y.createPolicy("lit-html",{createHTML:t=>t}):void 0,w=`lit$${(Math.random()+"").slice(9)}$`,$="?"+w,x=`<${$}>`,k=document,C=(t="")=>k.createComment(t),E=t=>null===t||"object"!=typeof t&&"function"!=typeof t,A=Array.isArray,S=t=>A(t)||"function"==typeof(null==t?void 0:t[Symbol.iterator]),T=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,L=/-->/g,D=/>/g,z=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),O=/'/g,N=/"/g,M=/^(?:script|style|textarea|title)$/i,j=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),I=Symbol.for("lit-noChange"),P=Symbol.for("lit-nothing"),B=new WeakMap,R=k.createTreeWalker(k,129,null,!1),U=(t,e)=>{const i=t.length-1,s=[];let o,n=2===e?"<svg>":"",r=T;for(let e=0;e<i;e++){const i=t[e];let a,l,h=-1,d=0;for(;d<i.length&&(r.lastIndex=d,l=r.exec(i),null!==l);)d=r.lastIndex,r===T?"!--"===l[1]?r=L:void 0!==l[1]?r=D:void 0!==l[2]?(M.test(l[2])&&(o=RegExp("</"+l[2],"g")),r=z):void 0!==l[3]&&(r=z):r===z?">"===l[0]?(r=null!=o?o:T,h=-1):void 0===l[1]?h=-2:(h=r.lastIndex-l[2].length,a=l[1],r=void 0===l[3]?z:'"'===l[3]?N:O):r===N||r===O?r=z:r===L||r===D?r=T:(r=z,o=void 0);const c=r===z&&t[e+1].startsWith("/>")?" ":"";n+=r===T?i+x:h>=0?(s.push(a),i.slice(0,h)+"$lit$"+i.slice(h)+w+c):i+w+(-2===h?(s.push(void 0),e):c)}const a=n+(t[i]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==b?b.createHTML(a):a,s]};class q{constructor({strings:t,_$litType$:e},i){let s;this.parts=[];let o=0,n=0;const r=t.length-1,a=this.parts,[l,h]=U(t,e);if(this.el=q.createElement(l,i),R.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(s=R.nextNode())&&a.length<r;){if(1===s.nodeType){if(s.hasAttributes()){const t=[];for(const e of s.getAttributeNames())if(e.endsWith("$lit$")||e.startsWith(w)){const i=h[n++];if(t.push(e),void 0!==i){const t=s.getAttribute(i.toLowerCase()+"$lit$").split(w),e=/([.?@])?(.*)/.exec(i);a.push({type:1,index:o,name:e[2],strings:t,ctor:"."===e[1]?W:"?"===e[1]?Z:"@"===e[1]?K:Y})}else a.push({type:6,index:o})}for(const e of t)s.removeAttribute(e)}if(M.test(s.tagName)){const t=s.textContent.split(w),e=t.length-1;if(e>0){s.textContent=y?y.emptyScript:"";for(let i=0;i<e;i++)s.append(t[i],C()),R.nextNode(),a.push({type:2,index:++o});s.append(t[e],C())}}}else if(8===s.nodeType)if(s.data===$)a.push({type:2,index:o});else{let t=-1;for(;-1!==(t=s.data.indexOf(w,t+1));)a.push({type:7,index:o}),t+=w.length-1}o++}}static createElement(t,e){const i=k.createElement("template");return i.innerHTML=t,i}}function V(t,e,i=t,s){var o,n,r,a;if(e===I)return e;let l=void 0!==s?null===(o=i._$Co)||void 0===o?void 0:o[s]:i._$Cl;const h=E(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==h&&(null===(n=null==l?void 0:l._$AO)||void 0===n||n.call(l,!1),void 0===h?l=void 0:(l=new h(t),l._$AT(t,i,s)),void 0!==s?(null!==(r=(a=i)._$Co)&&void 0!==r?r:a._$Co=[])[s]=l:i._$Cl=l),void 0!==l&&(e=V(t,l._$AS(t,e.values),l,s)),e}class F{constructor(t,e){this.u=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(t){var e;const{el:{content:i},parts:s}=this._$AD,o=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:k).importNode(i,!0);R.currentNode=o;let n=R.nextNode(),r=0,a=0,l=s[0];for(;void 0!==l;){if(r===l.index){let e;2===l.type?e=new H(n,n.nextSibling,this,t):1===l.type?e=new l.ctor(n,l.name,l.strings,this,t):6===l.type&&(e=new J(n,this,t)),this.u.push(e),l=s[++a]}r!==(null==l?void 0:l.index)&&(n=R.nextNode(),r++)}return o}p(t){let e=0;for(const i of this.u)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class H{constructor(t,e,i,s){var o;this.type=2,this._$AH=P,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=s,this._$Cm=null===(o=null==s?void 0:s.isConnected)||void 0===o||o}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cm}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=V(this,t,e),E(t)?t===P||null==t||""===t?(this._$AH!==P&&this._$AR(),this._$AH=P):t!==this._$AH&&t!==I&&this.g(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):S(t)?this.k(t):this.g(t)}O(t,e=this._$AB){return this._$AA.parentNode.insertBefore(t,e)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}g(t){this._$AH!==P&&E(this._$AH)?this._$AA.nextSibling.data=t:this.T(k.createTextNode(t)),this._$AH=t}$(t){var e;const{values:i,_$litType$:s}=t,o="number"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=q.createElement(s.h,this.options)),s);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===o)this._$AH.p(i);else{const t=new F(o,this),e=t.v(this.options);t.p(i),this.T(e),this._$AH=t}}_$AC(t){let e=B.get(t.strings);return void 0===e&&B.set(t.strings,e=new q(t)),e}k(t){A(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,s=0;for(const o of t)s===e.length?e.push(i=new H(this.O(C()),this.O(C()),this,this.options)):i=e[s],i._$AI(o),s++;s<e.length&&(this._$AR(i&&i._$AB.nextSibling,s),e.length=s)}_$AR(t=this._$AA.nextSibling,e){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cm=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class Y{constructor(t,e,i,s,o){this.type=1,this._$AH=P,this._$AN=void 0,this.element=t,this.name=e,this._$AM=s,this.options=o,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=P}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,i,s){const o=this.strings;let n=!1;if(void 0===o)t=V(this,t,e,0),n=!E(t)||t!==this._$AH&&t!==I,n&&(this._$AH=t);else{const s=t;let r,a;for(t=o[0],r=0;r<o.length-1;r++)a=V(this,s[i+r],e,r),a===I&&(a=this._$AH[r]),n||(n=!E(a)||a!==this._$AH[r]),a===P?t=P:t!==P&&(t+=(null!=a?a:"")+o[r+1]),this._$AH[r]=a}n&&!s&&this.j(t)}j(t){t===P?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class W extends Y{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===P?void 0:t}}const X=y?y.emptyScript:"";class Z extends Y{constructor(){super(...arguments),this.type=4}j(t){t&&t!==P?this.element.setAttribute(this.name,X):this.element.removeAttribute(this.name)}}class K extends Y{constructor(t,e,i,s,o){super(t,e,i,s,o),this.type=5}_$AI(t,e=this){var i;if((t=null!==(i=V(this,t,e,0))&&void 0!==i?i:P)===I)return;const s=this._$AH,o=t===P&&s!==P||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,n=t!==P&&(s===P||o);o&&this.element.removeEventListener(this.name,this,s),n&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,i;"function"==typeof this._$AH?this._$AH.call(null!==(i=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==i?i:this.element,t):this._$AH.handleEvent(t)}}class J{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){V(this,t)}}const Q={P:"$lit$",A:w,M:$,C:1,L:U,R:F,D:S,V:V,I:H,H:Y,N:Z,U:K,B:W,F:J},G=f.litHtmlPolyfillSupport;null==G||G(q,H),(null!==(m=f.litHtmlVersions)&&void 0!==m?m:f.litHtmlVersions=[]).push("2.5.0");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var tt,et;class it extends _{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,i)=>{var s,o;const n=null!==(s=null==i?void 0:i.renderBefore)&&void 0!==s?s:e;let r=n._$litPart$;if(void 0===r){const t=null!==(o=null==i?void 0:i.renderBefore)&&void 0!==o?o:null;n._$litPart$=r=new H(e.insertBefore(C(),t),t,void 0,null!=i?i:{})}return r._$AI(t),r})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return I}}it.finalized=!0,it._$litElement$=!0,null===(tt=globalThis.litElementHydrateSupport)||void 0===tt||tt.call(globalThis,{LitElement:it});const st=globalThis.litElementPolyfillSupport;null==st||st({LitElement:it}),(null!==(et=globalThis.litElementVersions)&&void 0!==et?et:globalThis.litElementVersions=[]).push("3.2.2");
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const{I:ot}=Q,nt=()=>document.createComment(""),rt=(t,e,i)=>{var s;const o=t._$AA.parentNode,n=void 0===e?t._$AB:e._$AA;if(void 0===i){const e=o.insertBefore(nt(),n),s=o.insertBefore(nt(),n);i=new ot(e,s,t,t.options)}else{const e=i._$AB.nextSibling,r=i._$AM,a=r!==t;if(a){let e;null===(s=i._$AQ)||void 0===s||s.call(i,t),i._$AM=t,void 0!==i._$AP&&(e=t._$AU)!==r._$AU&&i._$AP(e)}if(e!==n||a){let t=i._$AA;for(;t!==e;){const e=t.nextSibling;o.insertBefore(t,n),t=e}}}return i},at=(t,e,i=t)=>(t._$AI(e,i),t),lt={},ht=t=>{var e;null===(e=t._$AP)||void 0===e||e.call(t,!1,!0);let i=t._$AA;const s=t._$AB.nextSibling;for(;i!==s;){const t=i.nextSibling;i.remove(),i=t}},dt=2,ct=t=>(...e)=>({_$litDirective$:t,values:e});
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class ut{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const pt=(t,e)=>{var i,s;const o=t._$AN;if(void 0===o)return!1;for(const t of o)null===(s=(i=t)._$AO)||void 0===s||s.call(i,e,!1),pt(t,e);return!0},gt=t=>{let e,i;do{if(void 0===(e=t._$AM))break;i=e._$AN,i.delete(t),t=e}while(0===(null==i?void 0:i.size))},vt=t=>{for(let e;e=t._$AM;t=e){let i=e._$AN;if(void 0===i)e._$AN=i=new Set;else if(i.has(t))break;i.add(t),ft(e)}};function _t(t){void 0!==this._$AN?(gt(this),this._$AM=t,vt(this)):this._$AM=t}function mt(t,e=!1,i=0){const s=this._$AH,o=this._$AN;if(void 0!==o&&0!==o.size)if(e)if(Array.isArray(s))for(let t=i;t<s.length;t++)pt(s[t],!1),gt(s[t]);else null!=s&&(pt(s,!1),gt(s));else pt(this,t)}const ft=t=>{var e,i,s,o;t.type==dt&&(null!==(e=(s=t)._$AP)&&void 0!==e||(s._$AP=mt),null!==(i=(o=t)._$AQ)&&void 0!==i||(o._$AQ=_t))};class yt extends ut{constructor(){super(...arguments),this._$AN=void 0}_$AT(t,e,i){super._$AT(t,e,i),vt(this),this.isConnected=t._$AU}_$AO(t,e=!0){var i,s;t!==this.isConnected&&(this.isConnected=t,t?null===(i=this.reconnected)||void 0===i||i.call(this):null===(s=this.disconnected)||void 0===s||s.call(this)),e&&(pt(this,t),gt(this))}setValue(t){if((t=>void 0===t.strings)(this._$Ct))this._$Ct._$AI(t,this);else{const e=[...this._$Ct._$AH];e[this._$Ci]=t,this._$Ct._$AI(e,this,0)}}disconnected(){}reconnected(){}}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class bt{constructor(t){this.Y=t}disconnect(){this.Y=void 0}reconnect(t){this.Y=t}deref(){return this.Y}}class wt{constructor(){this.Z=void 0,this.q=void 0}get(){return this.Z}pause(){var t;null!==(t=this.Z)&&void 0!==t||(this.Z=new Promise((t=>this.q=t)))}resume(){var t;null===(t=this.q)||void 0===t||t.call(this),this.Z=this.q=void 0}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const $t=t=>!(t=>null===t||"object"!=typeof t&&"function"!=typeof t)(t)&&"function"==typeof t.then;const xt=ct(class extends yt{constructor(){super(...arguments),this._$Cwt=1073741823,this._$Cyt=[],this._$CK=new bt(this),this._$CX=new wt}render(...t){var e;return null!==(e=t.find((t=>!$t(t))))&&void 0!==e?e:I}update(t,e){const i=this._$Cyt;let s=i.length;this._$Cyt=e;const o=this._$CK,n=this._$CX;this.isConnected||this.disconnected();for(let t=0;t<e.length&&!(t>this._$Cwt);t++){const r=e[t];if(!$t(r))return this._$Cwt=t,r;t<s&&r===i[t]||(this._$Cwt=1073741823,s=0,Promise.resolve(r).then((async t=>{for(;n.get();)await n.get();const e=o.deref();if(void 0!==e){const i=e._$Cyt.indexOf(r);i>-1&&i<e._$Cwt&&(e._$Cwt=i,e.setValue(t))}})))}return I}disconnected(){this._$CK.disconnect(),this._$CX.pause()}reconnected(){this._$CK.reconnect(this),this._$CX.resume()}});
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const kt=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(i){i.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}};function Ct(t){return(e,i)=>void 0!==i?((t,e,i)=>{e.constructor.createProperty(i,t)})(t,e,i):kt(t,e)}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Et(t){return Ct({...t,state:!0})}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const At=({finisher:t,descriptor:e})=>(i,s)=>{var o;if(void 0===s){const s=null!==(o=i.originalKey)&&void 0!==o?o:i.key,n=null!=e?{kind:"method",placement:"prototype",key:s,descriptor:e(i.key)}:{...i,key:s};return null!=t&&(n.finisher=function(e){t(e,s)}),n}{const o=i.constructor;void 0!==e&&Object.defineProperty(i,s,e(s)),null==t||t(o,s)}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;function St(t,e){return At({descriptor:i=>{const s={get(){var e,i;return null!==(i=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t))&&void 0!==i?i:null},enumerable:!0,configurable:!0};if(e){const e="symbol"==typeof i?Symbol():"__"+i;s.get=function(){var i,s;return void 0===this[e]&&(this[e]=null!==(s=null===(i=this.renderRoot)||void 0===i?void 0:i.querySelector(t))&&void 0!==s?s:null),this[e]}}return s}})}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var Tt;const Lt=null!=(null===(Tt=window.HTMLSlotElement)||void 0===Tt?void 0:Tt.prototype.assignedElements)?(t,e)=>t.assignedElements(e):(t,e)=>t.assignedNodes(e).filter((t=>t.nodeType===Node.ELEMENT_NODE));
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const Dt=(t,e,i)=>{const s=new Map;for(let o=e;o<=i;o++)s.set(t[o],o);return s},zt=ct(class extends ut{constructor(t){if(super(t),t.type!==dt)throw Error("repeat() can only be used in text expressions")}ht(t,e,i){let s;void 0===i?i=e:void 0!==e&&(s=e);const o=[],n=[];let r=0;for(const e of t)o[r]=s?s(e,r):r,n[r]=i(e,r),r++;return{values:n,keys:o}}render(t,e,i){return this.ht(t,e,i).values}update(t,[e,i,s]){var o;const n=(t=>t._$AH)(t),{values:r,keys:a}=this.ht(e,i,s);if(!Array.isArray(n))return this.ut=a,r;const l=null!==(o=this.ut)&&void 0!==o?o:this.ut=[],h=[];let d,c,u=0,p=n.length-1,g=0,v=r.length-1;for(;u<=p&&g<=v;)if(null===n[u])u++;else if(null===n[p])p--;else if(l[u]===a[g])h[g]=at(n[u],r[g]),u++,g++;else if(l[p]===a[v])h[v]=at(n[p],r[v]),p--,v--;else if(l[u]===a[v])h[v]=at(n[u],r[v]),rt(t,h[v+1],n[u]),u++,v--;else if(l[p]===a[g])h[g]=at(n[p],r[g]),rt(t,n[u],n[p]),p--,g++;else if(void 0===d&&(d=Dt(a,g,v),c=Dt(l,u,p)),d.has(l[u]))if(d.has(l[p])){const e=c.get(a[g]),i=void 0!==e?n[e]:null;if(null===i){const e=rt(t,n[u]);at(e,r[g]),h[g]=e}else h[g]=at(i,r[g]),rt(t,n[u],i),n[e]=null;g++}else ht(n[p]),p--;else ht(n[u]),u++;for(;g<=v;){const e=rt(t,h[v+1]);at(e,r[g]),h[g++]=e}for(;u<=p;){const t=n[u++];null!==t&&ht(t)}return this.ut=a,((t,e=lt)=>{t._$AH=e})(t,h),I}});
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Ot,Nt;async function Mt(){return Nt||async function(){if(Ot)return(await Ot).default;Ot=window.ResizeObserver;try{new Ot((function(){}))}catch(t){Ot=import("./7f7cb14f.js"),Ot=(await Ot).default}return Nt=Ot}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */()}class jt extends Event{constructor(t){super(jt.eventName,{bubbles:!0}),this.first=t.first,this.last=t.last}}jt.eventName="rangeChanged";class It extends Event{constructor(t){super(It.eventName,{bubbles:!0}),this.first=t.first,this.last=t.last}}It.eventName="visibilityChanged";class Pt extends Event{constructor(){super(Pt.eventName,{bubbles:!1})}}Pt.eventName="unpinned";
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
class Bt{constructor(t){this._node=null,this._element=null;const e=null!=t?t:window;this._node=e,t&&(this._element=t)}get element(){return this._element||document.scrollingElement||document.documentElement}get scrollTop(){return this.element.scrollTop||window.scrollY}get scrollLeft(){return this.element.scrollLeft||window.scrollX}get scrollHeight(){return this.element.scrollHeight}get scrollWidth(){return this.element.scrollWidth}get viewportHeight(){return this._element?this._element.getBoundingClientRect().height:window.innerHeight}get viewportWidth(){return this._element?this._element.getBoundingClientRect().width:window.innerWidth}get maxScrollTop(){return this.scrollHeight-this.viewportHeight}get maxScrollLeft(){return this.scrollWidth-this.viewportWidth}}class Rt extends Bt{constructor(t,e){super(e),this._originalScrollTo=null,this._originalScrollBy=null,this._originalScroll=null,this._clients=[],this._retarget=null,this._end=null,this.__destination=null,this.correctingScrollError=!1;const i=this._node,s=Rt._instanceMap.get(i);if(s)return s._attach(t),s;this._checkForArrival=this._checkForArrival.bind(this),this._updateManagedScrollTo=this._updateManagedScrollTo.bind(this),this.scrollTo=this.scrollTo.bind(this),this.scrollBy=this.scrollBy.bind(this),this._originalScrollTo=i.scrollTo,this._originalScrollBy=i.scrollBy,this._originalScroll=i.scroll,this._attach(t)}get _destination(){return this.__destination}get scrolling(){return null!==this._destination}scrollTo(t,e){const i="number"==typeof t&&"number"==typeof e?{left:t,top:e}:t;this._scrollTo(i)}scrollBy(t,e){const i="number"==typeof t&&"number"==typeof e?{left:t,top:e}:t;void 0!==i.top&&(i.top+=this.scrollTop),void 0!==i.left&&(i.left+=this.scrollLeft),this._scrollTo(i)}_nativeScrollTo(t){this._originalScrollTo.bind(this._element||window)(t)}_scrollTo(t,e=null,i=null){null!==this._end&&this._end(),"smooth"===t.behavior?(this._setDestination(t),this._retarget=e,this._end=i):this._resetScrollState(),this._nativeScrollTo(t)}_setDestination(t){let{top:e,left:i}=t;return e=void 0===e?void 0:Math.max(0,Math.min(e,this.maxScrollTop)),i=void 0===i?void 0:Math.max(0,Math.min(i,this.maxScrollLeft)),(null===this._destination||i!==this._destination.left||e!==this._destination.top)&&(this.__destination={top:e,left:i,behavior:"smooth"},!0)}_resetScrollState(){this.__destination=null,this._retarget=null,this._end=null}_updateManagedScrollTo(t){this._destination&&this._setDestination(t)&&this._nativeScrollTo(this._destination)}managedScrollTo(t,e,i){return this._scrollTo(t,e,i),this._updateManagedScrollTo}correctScrollError(t){this.correctingScrollError=!0,requestAnimationFrame((()=>requestAnimationFrame((()=>this.correctingScrollError=!1)))),this._nativeScrollTo(t),this._retarget&&this._setDestination(this._retarget()),this._destination&&this._nativeScrollTo(this._destination)}_checkForArrival(){if(null!==this._destination){const{scrollTop:t,scrollLeft:e}=this;let{top:i,left:s}=this._destination;i=Math.min(i||0,this.maxScrollTop),s=Math.min(s||0,this.maxScrollLeft);const o=Math.abs(i-t),n=Math.abs(s-e);o<1&&n<1&&(this._end&&this._end(),this._resetScrollState())}}detach(t){return this._clients=this._clients.splice(this._clients.indexOf(t),1),0===this._clients.length&&(this._node.scrollTo=this._originalScrollTo,this._node.scrollBy=this._originalScrollBy,this._node.scroll=this._originalScroll,this._node.removeEventListener("scroll",this._checkForArrival)),null}_attach(t){this._clients.push(t),1===this._clients.length&&(this._node.scrollTo=this.scrollTo,this._node.scrollBy=this.scrollBy,this._node.scroll=this.scrollTo,this._node.addEventListener("scroll",this._checkForArrival))}}Rt._instanceMap=new WeakMap;
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const Ut=Symbol("virtualizerRef"),qt="virtualizer-sizer";let Vt;class Ft{constructor(t){if(this._benchmarkStart=null,this._layout=null,this._clippingAncestors=[],this._scrollSize=null,this._scrollError=null,this._childrenPos=null,this._childMeasurements=null,this._toBeMeasured=new Map,this._rangeChanged=!0,this._itemsChanged=!0,this._visibilityChanged=!0,this._scrollerController=null,this._isScroller=!1,this._sizer=null,this._hostElementRO=null,this._childrenRO=null,this._mutationObserver=null,this._scrollEventListeners=[],this._scrollEventListenerOptions={passive:!0},this._loadListener=this._childLoaded.bind(this),this._scrollIntoViewTarget=null,this._updateScrollIntoViewCoordinates=null,this._items=[],this._first=-1,this._last=-1,this._firstVisible=-1,this._lastVisible=-1,this._scheduled=new WeakSet,this._measureCallback=null,this._measureChildOverride=null,this._layoutCompletePromise=null,this._layoutCompleteResolver=null,this._layoutCompleteRejecter=null,this._pendingLayoutComplete=null,!t)throw new Error("Virtualizer constructor requires a configuration object");if(!t.hostElement)throw new Error('Virtualizer configuration requires the "hostElement" property');this._init(t)}set items(t){Array.isArray(t)&&t!==this._items&&(this._itemsChanged=!0,this._items=t,this._schedule(this._updateLayout))}_init(t){this._isScroller=!!t.scroller,this._initHostElement(t),this._initLayout(t.layout||{})}async _initObservers(){this._mutationObserver=new MutationObserver(this._finishDOMUpdate.bind(this));const t=await Mt();this._hostElementRO=new t((()=>this._hostElementSizeChanged())),this._childrenRO=new t(this._childrenSizeChanged.bind(this))}_initHostElement(t){const e=this._hostElement=t.hostElement;this._applyVirtualizerStyles(),e[Ut]=this}async connected(){await this._initObservers();const t=this._isScroller;this._clippingAncestors=function(t,e=!1){return function(t,e=!1){const i=[];let s=e?t:Yt(t);for(;null!==s;)i.push(s),s=Yt(s);return i}(t,e).filter((t=>"visible"!==getComputedStyle(t).overflow))}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */(this._hostElement,t),this._scrollerController=new Rt(this,this._clippingAncestors[0]),this._schedule(this._updateLayout),this._observeAndListen()}_observeAndListen(){this._mutationObserver.observe(this._hostElement,{childList:!0}),this._hostElementRO.observe(this._hostElement),this._scrollEventListeners.push(window),window.addEventListener("scroll",this,this._scrollEventListenerOptions),this._clippingAncestors.forEach((t=>{t.addEventListener("scroll",this,this._scrollEventListenerOptions),this._scrollEventListeners.push(t),this._hostElementRO.observe(t)})),this._hostElementRO.observe(this._scrollerController.element),this._children.forEach((t=>this._childrenRO.observe(t))),this._scrollEventListeners.forEach((t=>t.addEventListener("scroll",this,this._scrollEventListenerOptions)))}disconnected(){var t,e,i,s;this._scrollEventListeners.forEach((t=>t.removeEventListener("scroll",this,this._scrollEventListenerOptions))),this._scrollEventListeners=[],this._clippingAncestors=[],this._scrollerController=(null===(t=this._scrollerController)||void 0===t?void 0:t.detach(this))||null,null===(e=this._mutationObserver)||void 0===e||e.disconnect(),null===(i=this._hostElementRO)||void 0===i||i.disconnect(),null===(s=this._childrenRO)||void 0===s||s.disconnect(),this._rejectLayoutCompletePromise("disconnected")}_applyVirtualizerStyles(){const t=this._hostElement.style;t.display=t.display||"block",t.position=t.position||"relative",t.contain=t.contain||"size layout",this._isScroller&&(t.overflow=t.overflow||"auto",t.minHeight=t.minHeight||"150px")}_getSizer(){const t=this._hostElement;if(!this._sizer){let e=t.querySelector(`[${qt}]`);e||(e=document.createElement("div"),e.setAttribute(qt,""),t.appendChild(e)),Object.assign(e.style,{position:"absolute",margin:"-2px 0 0 0",padding:0,visibility:"hidden",fontSize:"2px"}),e.innerHTML="&nbsp;",e.setAttribute(qt,""),this._sizer=e}return this._sizer}updateLayoutConfig(t){const e=t.type||Vt;if("function"==typeof e&&this._layout instanceof e){const e={...t};return delete e.type,this._layout.config=e,!0}return!1}async _initLayout(t){let e,i;if("function"==typeof t.type){i=t.type;const s={...t};delete s.type,e=s}else e=t;void 0===i&&(Vt=i=(await import("./57ab9836.js")).FlowLayout),this._layout=new i(e),this._layout.measureChildren&&"function"==typeof this._layout.updateItemSizes&&("function"==typeof this._layout.measureChildren&&(this._measureChildOverride=this._layout.measureChildren),this._measureCallback=this._layout.updateItemSizes.bind(this._layout)),this._layout.addEventListener("scrollsizechange",this),this._layout.addEventListener("scrollerrorchange",this),this._layout.addEventListener("itempositionchange",this),this._layout.addEventListener("rangechange",this),this._layout.addEventListener("unpinned",this),this._layout.listenForChildLoadEvents&&this._hostElement.addEventListener("load",this._loadListener,!0),this._schedule(this._updateLayout)}startBenchmarking(){null===this._benchmarkStart&&(this._benchmarkStart=window.performance.now())}stopBenchmarking(){if(null!==this._benchmarkStart){const t=window.performance.now(),e=t-this._benchmarkStart,i=performance.getEntriesByName("uv-virtualizing","measure").filter((e=>e.startTime>=this._benchmarkStart&&e.startTime<t)).reduce(((t,e)=>t+e.duration),0);return this._benchmarkStart=null,{timeElapsed:e,virtualizationTime:i}}return null}_measureChildren(){const t={},e=this._children,i=this._measureChildOverride||this._measureChild;for(let s=0;s<e.length;s++){const o=e[s],n=this._first+s;(this._itemsChanged||this._toBeMeasured.has(o))&&(t[n]=i.call(this,o,this._items[n]))}this._childMeasurements=t,this._schedule(this._updateLayout),this._toBeMeasured.clear()}_measureChild(t){const{width:e,height:i}=t.getBoundingClientRect();return Object.assign({width:e,height:i},function(t){const e=window.getComputedStyle(t);return{marginTop:Ht(e.marginTop),marginRight:Ht(e.marginRight),marginBottom:Ht(e.marginBottom),marginLeft:Ht(e.marginLeft)}}(t))}async _schedule(t){this._scheduled.has(t)||(this._scheduled.add(t),await Promise.resolve(),this._scheduled.delete(t),t.call(this))}async _updateDOM(){const{_rangeChanged:t,_itemsChanged:e}=this;this._visibilityChanged&&(this._notifyVisibility(),this._visibilityChanged=!1),t||e?(this._notifyRange(),this._rangeChanged=!1):this._finishDOMUpdate()}_finishDOMUpdate(){this._children.forEach((t=>this._childrenRO.observe(t))),this._checkScrollIntoViewTarget(this._childrenPos),this._positionChildren(this._childrenPos),this._sizeHostElement(this._scrollSize),this._correctScrollError(),this._benchmarkStart&&"mark"in window.performance&&window.performance.mark("uv-end")}_updateLayout(){this._layout&&(this._layout.items=this._items,this._updateView(),null!==this._childMeasurements&&(this._measureCallback&&this._measureCallback(this._childMeasurements),this._childMeasurements=null),this._layout.reflowIfNeeded(),this._benchmarkStart&&"mark"in window.performance&&window.performance.mark("uv-end"))}_handleScrollEvent(){var t;if(this._benchmarkStart&&"mark"in window.performance){try{window.performance.measure("uv-virtualizing","uv-start","uv-end")}catch(t){console.warn("Error measuring performance data: ",t)}window.performance.mark("uv-start")}!1===this._scrollerController.correctingScrollError&&(null===(t=this._layout)||void 0===t||t.unpin()),this._schedule(this._updateLayout)}handleEvent(t){switch(t.type){case"scroll":(t.currentTarget===window||this._clippingAncestors.includes(t.currentTarget))&&this._handleScrollEvent();break;case"scrollsizechange":this._scrollSize=t.detail,this._schedule(this._updateDOM);break;case"scrollerrorchange":this._scrollError=t.detail,this._schedule(this._updateDOM);break;case"itempositionchange":this._childrenPos=t.detail,this._schedule(this._updateDOM);break;case"rangechange":this._adjustRange(t.detail),this._schedule(this._updateDOM);break;case"unpinned":this._hostElement.dispatchEvent(new Pt);break;default:console.warn("event not handled",t)}}get _children(){const t=[];let e=this._hostElement.firstElementChild;for(;e;)e.hasAttribute(qt)||t.push(e),e=e.nextElementSibling;return t}_updateView(){var t;const e=this._hostElement,i=null===(t=this._scrollerController)||void 0===t?void 0:t.element,s=this._layout;if(e&&i&&s){let t,o,n,r;const a=e.getBoundingClientRect();t=0,o=0,n=window.innerHeight,r=window.innerWidth;const l=this._clippingAncestors.map((t=>t.getBoundingClientRect()));l.unshift(a);for(const e of l)t=Math.max(t,e.top),o=Math.max(o,e.left),n=Math.min(n,e.bottom),r=Math.min(r,e.right);const h=i.getBoundingClientRect(),d={left:a.left-h.left,top:a.top-h.top},c={width:i.scrollWidth,height:i.scrollHeight},u=t-a.top+e.scrollTop,p=o-a.left+e.scrollLeft,g=Math.max(1,n-t),v=Math.max(1,r-o);s.viewportSize={width:v,height:g},s.viewportScroll={top:u,left:p},s.totalScrollSize=c,s.offsetWithinScroller=d}}_sizeHostElement(t){const e=82e5,i=t&&null!==t.width?Math.min(e,t.width):0,s=t&&null!==t.height?Math.min(e,t.height):0;if(this._isScroller)this._getSizer().style.transform=`translate(${i}px, ${s}px)`;else{const t=this._hostElement.style;t.minWidth=i?`${i}px`:"100%",t.minHeight=s?`${s}px`:"100%"}}_positionChildren(t){t&&t.forEach((({top:t,left:e,width:i,height:s,xOffset:o,yOffset:n},r)=>{const a=this._children[r-this._first];a&&(a.style.position="absolute",a.style.boxSizing="border-box",a.style.transform=`translate(${e}px, ${t}px)`,void 0!==i&&(a.style.width=i+"px"),void 0!==s&&(a.style.height=s+"px"),a.style.left=void 0===o?null:o+"px",a.style.top=void 0===n?null:n+"px")}))}async _adjustRange(t){const{_first:e,_last:i,_firstVisible:s,_lastVisible:o}=this;this._first=t.first,this._last=t.last,this._firstVisible=t.firstVisible,this._lastVisible=t.lastVisible,this._rangeChanged=this._rangeChanged||this._first!==e||this._last!==i,this._visibilityChanged=this._visibilityChanged||this._firstVisible!==s||this._lastVisible!==o}_correctScrollError(){if(this._scrollError){const{scrollTop:t,scrollLeft:e}=this._scrollerController,{top:i,left:s}=this._scrollError;this._scrollError=null,this._scrollerController.correctScrollError({top:t-i,left:e-s})}}element(t){var e;return t===1/0&&(t=this._items.length-1),void 0===(null===(e=this._items)||void 0===e?void 0:e[t])?void 0:{scrollIntoView:(e={})=>this._scrollElementIntoView({...e,index:t})}}_scrollElementIntoView(t){if(t.index>=this._first&&t.index<=this._last)this._children[t.index-this._first].scrollIntoView(t);else if(t.index=Math.min(t.index,this._items.length-1),"smooth"===t.behavior){const e=this._layout.getScrollIntoViewCoordinates(t),{behavior:i}=t;this._updateScrollIntoViewCoordinates=this._scrollerController.managedScrollTo(Object.assign(e,{behavior:i}),(()=>this._layout.getScrollIntoViewCoordinates(t)),(()=>this._scrollIntoViewTarget=null)),this._scrollIntoViewTarget=t}else this._layout.pin=t}_checkScrollIntoViewTarget(t){const{index:e}=this._scrollIntoViewTarget||{};e&&(null==t?void 0:t.has(e))&&this._updateScrollIntoViewCoordinates(this._layout.getScrollIntoViewCoordinates(this._scrollIntoViewTarget))}_notifyRange(){this._hostElement.dispatchEvent(new jt({first:this._first,last:this._last}))}_notifyVisibility(){this._hostElement.dispatchEvent(new It({first:this._firstVisible,last:this._lastVisible}))}get layoutComplete(){return this._layoutCompletePromise||(this._layoutCompletePromise=new Promise(((t,e)=>{this._layoutCompleteResolver=t,this._layoutCompleteRejecter=e}))),this._layoutCompletePromise}_rejectLayoutCompletePromise(t){null!==this._layoutCompleteRejecter&&this._layoutCompleteRejecter(t),this._resetLayoutCompleteState()}_scheduleLayoutComplete(){this._layoutCompletePromise&&null===this._pendingLayoutComplete&&(this._pendingLayoutComplete=requestAnimationFrame((()=>requestAnimationFrame((()=>this._resolveLayoutCompletePromise())))))}_resolveLayoutCompletePromise(){null!==this._layoutCompleteResolver&&this._layoutCompleteResolver(),this._resetLayoutCompleteState()}_resetLayoutCompleteState(){this._layoutCompletePromise=null,this._layoutCompleteResolver=null,this._layoutCompleteRejecter=null,this._pendingLayoutComplete=null}_hostElementSizeChanged(){this._schedule(this._updateLayout)}_childLoaded(){}_childrenSizeChanged(t){if(this._layout.measureChildren){for(const e of t)this._toBeMeasured.set(e.target,e.contentRect);this._measureChildren()}this._scheduleLayoutComplete(),this._itemsChanged=!1,this._rangeChanged=!1}}function Ht(t){const e=t?parseFloat(t):NaN;return Number.isNaN(e)?0:e}function Yt(t){if(null!==t.assignedSlot)return t.assignedSlot;if(null!==t.parentElement)return t.parentElement;const e=t.parentNode;return e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host||null}const Wt=t=>t,Xt=(t,e)=>j`${e}: ${JSON.stringify(t,null,2)}`;const Zt=ct(class extends yt{constructor(t){if(super(t),this._virtualizer=null,this._first=0,this._last=-1,this._renderItem=(t,e)=>Xt(t,e+this._first),this._keyFunction=(t,e)=>Wt(t,this._first),this._items=[],t.type!==dt)throw new Error("The virtualize directive can only be used in child expressions")}render(t){t&&this._setFunctions(t);const e=[],i=Math.min(this._items.length,this._last+1);if(this._first>=0&&this._last>=this._first)for(let t=this._first;t<i;t++)e.push(this._items[t]);return zt(e,this._keyFunction,this._renderItem)}update(t,[e]){return this._setFunctions(e),this._items=e.items||[],this._virtualizer?this._updateVirtualizerConfig(t,e):this._initialize(t,e),this.render()}_updateVirtualizerConfig(t,e){if(!this._virtualizer.updateLayoutConfig(e.layout||{})){const i=t.parentNode;this._makeVirtualizer(i,e)}this._virtualizer.items=this._items}_setFunctions(t){const{renderItem:e,keyFunction:i}=t;e&&(this._renderItem=(t,i)=>e(t,i+this._first)),i&&(this._keyFunction=(t,e)=>i(t,e+this._first))}_makeVirtualizer(t,e){this._virtualizer&&this._virtualizer.disconnected();const{layout:i,scroller:s,items:o}=e;this._virtualizer=new Ft({hostElement:t,layout:i,scroller:s}),this._virtualizer.items=o,this._virtualizer.connected()}_initialize(t,e){const i=t.parentNode;i&&1===i.nodeType&&(i.addEventListener("rangeChanged",(t=>{t.stopPropagation(),this._first=t.first,this._last=t.last,this.setValue(this.render())})),this._makeVirtualizer(i,e))}disconnected(){var t;null===(t=this._virtualizer)||void 0===t||t.disconnected()}reconnected(){var t;null===(t=this._virtualizer)||void 0===t||t.connected()}});
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class Kt extends it{constructor(){super(...arguments),this.items=[],this.renderItem=Xt,this.keyFunction=Wt,this.layout={},this.scroller=!1}createRenderRoot(){return this}render(){const{items:t,renderItem:e,keyFunction:i,layout:s,scroller:o}=this;return j`${Zt({items:t,renderItem:e,keyFunction:i,layout:s,scroller:o})}`}element(t){var e;return null===(e=this[Ut])||void 0===e?void 0:e.element(t)}get layoutComplete(){var t;return null===(t=this[Ut])||void 0===t?void 0:t.layoutComplete}scrollToIndex(t,e="start"){var i;null===(i=this.element(t))||void 0===i||i.scrollIntoView({block:e})}}t([Ct({attribute:!1})],Kt.prototype,"items",void 0),t([Ct()],Kt.prototype,"renderItem",void 0),t([Ct()],Kt.prototype,"keyFunction",void 0),t([Ct({attribute:!1})],Kt.prototype,"layout",void 0),t([Ct({reflect:!0,type:Boolean})],Kt.prototype,"scroller",void 0),
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
customElements.define("lit-virtualizer",Kt);const Jt=j` <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve" width="32px" height="32px"> <g> <circle fill="currentColor" cx="256" cy="298.667" r="42.667"/> <path fill="currentColor" d="M480.768,87.936l-56.704-56.704c-5.674-5.585-11.957-10.515-18.731-14.699V64   c-0.071,58.881-47.786,106.596-106.667,106.667h-85.333C154.452,170.596,106.737,122.881,106.667,64V0   C47.786,0.071,0.071,47.786,0,106.667v298.667C0.071,464.215,47.786,511.93,106.667,512h298.667   C464.214,511.93,511.93,464.215,512,405.334V163.35C512.08,135.049,500.833,107.893,480.768,87.936z M256,384   c-47.128,0-85.333-38.205-85.333-85.333s38.205-85.333,85.333-85.333s85.333,38.205,85.333,85.333S303.128,384,256,384z"/> <path fill="currentColor" d="M213.333,128h85.333c35.346,0,64-28.654,64-64V1.366c-4.638-0.756-9.32-1.212-14.016-1.365H149.333v64   C149.333,99.346,177.987,128,213.333,128z"/> </g> </svg> `,Qt=j` <svg class="deleteIcon" width="32px" height="32px" style="vertical-align:middle;fill:currentColor;overflow:hidden" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"> <path class="top" d="M 800 128 L 640 128 L 640 96 C 639.66 78.47 625.53 64.34 608 64 L 416 64 C 398.327 64 384 78.327 384 96 L 384 128 L 224 128 C 205.853 126.799 190.799 141.853 192 160 C 190.799 178.147 205.853 193.201 224 192 L 800 192 C 818.147 193.201 833.201 178.147 832 160 C 833.201 141.853 818.147 126.799 800 128 Z"/> <path d="M800 256 L 224 256 C 205.853 254.799 190.799 269.853 192 288 C 190.799 306.147 205.853 321.201 224 320 L 256 320 L 256 896 C 256 931.346 284.654 960 320 960 L 704 960 C 739.346 960 768 931.346 768 896 L 768 320 L 800 320 C 818.147 321.201 833.201 306.147 832 288 C 833.201 269.853 818.147 254.799 800 256 Z M 448 799.36 C 440.963 823.994 409.899 831.772 392.084 813.361 C 388.279 809.43 385.503 804.621 384 799.36 L 384 415.36 C 391.037 390.726 422.101 382.948 439.916 401.359 C 443.721 405.29 446.497 410.099 448 415.36 L 448 799.36 Z M 640 799.36 C 632.963 823.994 601.899 831.772 584.084 813.361 C 580.279 809.43 577.503 804.621 576 799.36 L 576 415.36 C 583.037 390.726 614.101 382.948 631.916 401.359 C 635.721 405.29 638.497 410.099 640 415.36 L 640 799.36 Z"></path> </svg> `,Gt=j` <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 280 280" width="280px" height="280px" xml:space="preserve"> <g> <path style="fill:#d07c40" d="M149.823,257.142c-31.398,30.698-81.882,30.576-113.105-0.429
            c-31.214-30.987-31.337-81.129-0.42-112.308l-0.026-0.018L149.841,31.615l14.203-14.098c23.522-23.356,61.65-23.356,85.172,0
            s23.522,61.221,0,84.586l-125.19,123.02l-0.044-0.035c-15.428,14.771-40.018,14.666-55.262-0.394
            c-15.244-15.069-15.34-39.361-0.394-54.588l-0.044-0.053l13.94-13.756l69.701-68.843l13.931,13.774l-83.632,82.599
            c-7.701,7.596-7.701,19.926,0,27.53s20.188,7.604,27.88,0L235.02,87.987l-0.035-0.026l0.473-0.403
            c15.682-15.568,15.682-40.823,0-56.39s-41.094-15.568-56.776,0l-0.42,0.473l-0.026-0.018l-14.194,14.089L50.466,158.485
            c-23.522,23.356-23.522,61.221,0,84.577s61.659,23.356,85.163,0l99.375-98.675l14.194-14.089l14.194,14.089l-14.194,14.098
            l-99.357,98.675C149.841,257.159,149.823,257.142,149.823,257.142z"/> </g> </svg> `,te=j` <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="32px" height="32px" viewBox="0 0 24 24" id="Capa_1" x="0px" y="0px" xml:space="preserve"> <path fill="currentColor" d="M13.5 2c-5.621 0-10.211 4.443-10.475 10h-3.025l5 6.625 5-6.625h-2.975c.257-3.351 3.06-6 6.475-6 3.584 0 6.5 2.916 6.5 6.5s-2.916 6.5-6.5 6.5c-1.863 0-3.542-.793-4.728-2.053l-2.427 3.216c1.877 1.754 4.389 2.837 7.155 2.837 5.79 0 10.5-4.71 10.5-10.5s-4.71-10.5-10.5-10.5z"/> </svg> `,ee=j` <svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 80 80"> <path d="M 25.797 40.006 L 36.52 19.13 C 37.057 18.09 38.151 17.457 39.32 17.51 L 45.73 17.83" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <path d="M57.73,18.39l8.48.47a3,3,0,0,1,2.63,4.08l-16.74,42a3,3,0,0,1-3.38,1.82l-29.29-6a3,3,0,0,1-2.05-4.29L26.06,39.5" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <polyline points="64.08 21.9 48.38 60.35 22.02 55.57" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <path d="M53.93,22.06l-6.24-.4a2.1,2.1,0,0,1-1.95-2.09V15.28A2.08,2.08,0,0,1,48,13.2l8.61.59a2.08,2.08,0,0,1,1.66,3.12L55.87,21A2.07,2.07,0,0,1,53.93,22.06Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <line x1="38.91" y1="28.8" x2="54.48" y2="30.19" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <line x1="36.82" y1="33.38" x2="52.39" y2="35" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <line x1="34.853" y1="38.033" x2="50.29" y2="39.81" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <line x1="32.793" y1="42.573" x2="48.2" y2="44.62" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> <path class="pen" d="M36.7,38.34,41.92,49.5l-11-5.36a2.49,2.49,0,0,1-.59-.41L11.62,25.06c-1.17-1.17-.77-3.45.88-5.11h0c1.66-1.66,3.95-2.05,5.11-.88L36.27,37.72A2.29,2.29,0,0,1,36.7,38.34Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"/> </svg> `,ie=j` <svg height="32px" width="45px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 32"> <g stroke="currentColor" fill="none" stroke-width="3"> <polyline points="9 3 2 16 9 28"/> </g> <g fill="currentColor"> <rect x="14" y="3" width="5" height="5"/> <rect x="14" y="13" width="5" height="5"/> <rect x="14" y="23" width="5" height="5"/> </g> <g fill="currentColor"> <rect x="24" y="3" width="20" height="5"/> <rect x="24" y="13" width="20" height="5"/> <rect x="24" y="23" width="20" height="5"/> </g> </svg>`,se=j` <svg stroke="currentColor" height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"> <g stroke-width="2"> <polyline fill="none" points="20 5 5 5 5 27 20 27"/> <line x1="10" y1="16" x2="26" y2="16"/> <polyline fill="none" points="22 10 26 16 22 22"/> </g> </svg>`,oe={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};function ne(t){let e="";for(var i=0,s=t.length;i<s;i++)e+=t.charCodeAt(i).toString(16);return e}function re(t){return{_id:t._id,_rev:t._rev,title:t.title,author:t.author,content:t.content,createdAt:t.createdAt.getTime(),_attachments:t._attachments,labels:t.labels}}function ae(t){if(!function(t){return Object.keys(t),t.hasOwnProperty("_id")&&"string"==typeof t._id&&t.hasOwnProperty("_rev")&&"string"==typeof t._rev&&t.hasOwnProperty("title")&&"string"==typeof t.title&&t.hasOwnProperty("author")&&"string"==typeof t.author&&t.hasOwnProperty("content")&&"string"==typeof t.content&&t.hasOwnProperty("createdAt")&&"number"==typeof t.createdAt&&t.hasOwnProperty("labels")&&t.labels instanceof Array&&t.labels.every(le)&&(void 0===t._attachments||(t._attachments instanceof Map||t._attachments instanceof Object)&&[...Object.values(t._attachments)].every(he))}(t))return;const e=t._attachments||new Map,i=t.labels||[];return{_id:t._id,_rev:t._rev,title:t.title,author:t.author,content:t.content,createdAt:new Date(t.createdAt),_attachments:new Map(Object.entries(e)),labels:[...i]}}function le(t){return t.hasOwnProperty("key")&&"string"==typeof t.key&&t.hasOwnProperty("value")&&"string"==typeof t.value}function he(t){return t.hasOwnProperty("content_type")&&"string"==typeof t.content_type&&t.hasOwnProperty("revpos")&&"number"==typeof t.revpos&&t.hasOwnProperty("digest")&&"string"==typeof t.digest&&t.hasOwnProperty("length")&&"number"==typeof t.length}new URL(new URL("bc536109.svg",import.meta.url).href,import.meta.url).href,new URL(new URL("62208f11.svg",import.meta.url).href,import.meta.url).href;class de extends it{onDeleteClick(t){t.preventDefault(),t.stopPropagation(),this.dispatchEvent(new CustomEvent("delete",{detail:this.note}))}render(){var t,e,i,s,o,n,r;const a=[...this.note._attachments.entries()];return j` <h2 class="title">${null===(t=this.note)||void 0===t?void 0:t.title}&nbsp;${((null===(e=this.note)||void 0===e?void 0:e.labels)||[]).map((t=>j`<quick-note-tag .key="${t.key}" .value="${t.value}"></quick-note-tag>`))}</h2> <div class="attachments" ?hidden="${0==a.length}"> <div>${a.length}</div> ${Gt} </div> <p class="createdAt">🕘 ${null===(i=this.note)||void 0===i?void 0:i.createdAt.toLocaleDateString(navigator.language,oe)}</p> <p class="content">${null===(s=this.note)||void 0===s?void 0:s.content}<i class="noContent" ?hidden="${void 0!==(null===(o=this.note)||void 0===o?void 0:o.content)&&""!==(null===(n=this.note)||void 0===n?void 0:n.content)}">No content</i></p> <p class="author">${null===(r=this.note)||void 0===r?void 0:r.author}</p> <button class="delete" @click="${this.onDeleteClick}"> ${Qt} </button> `}}de.styles=r`:host{margin:0;padding:5px;width:100%;cursor:pointer;box-sizing:border-box;display:grid;grid-template-columns:auto 1fr auto auto;grid-template-rows:1fr 1fr;grid-column-gap:0;grid-row-gap:0;transition:background-color .1s}.attachments[hidden]{display:unset;visibility:hidden}.title{text-align:left;font-size:large;margin:0;grid-row-start:1;grid-column-start:1;grid-row-end:2;grid-column-end:3}.attachments{grid-row-start:1;grid-column-start:3;grid-row-end:2;grid-column-end:4;margin:0 3px 1.5px 3px;height:32px;display:flex;justify-content:flex-end;position:relative}.attachments div{--inner-padding:1px;--inner-size:26px;position:relative;top:5px;left:10px;border:1px solid gray;background:rgba(255,255,255,.5);border-radius:calc(var(--inner-size)/ 2 + var(--inner-padding)*2);min-width:var(--inner-size);color:#000;height:var(--inner-size);font-size:small;line-height:var(--inner-size);padding:var(--inner-padding)}.attachments svg{height:100%}.createdAt{margin:0;text-align:left;border-right:1px solid gray;padding-right:5px;grid-row-start:2;grid-column-start:1;grid-row-end:3;grid-column-end:2}.content{margin:0 3px 0 5px;text-align:left;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;grid-row-start:2;grid-column-start:2;grid-row-end:3;grid-column-end:3}.author{margin:1.5px 3px 0 3px;text-align:right;grid-row-start:2;grid-column-start:3;grid-row-end:3;grid-column-end:4}.edit{grid-row-start:1;grid-row-end:2;grid-column-start:4;grid-column-end:5}.delete{grid-row-start:1;grid-row-end:3;grid-column-start:4;grid-column-end:5;margin:auto;margin-left:10px;padding:2px;border:0;display:inherit;border-radius:50%;background:0 0;transform:scale(1);transition:transform .2s}.delete:hover{background:#fffFFFF0;color:#692b2b}.deleteIcon{margin:0}.delete:hover{transform:scale(1.2)}.deleteIcon .top{transition:transform .2s;transform-origin:bottom;animation:closeTrash .5s forwards}.deleteIcon:hover .top{animation:openTrash .5s forwards}@keyframes openTrash{0%{transform:translateY(50px)}50%{transform:translateY(0)}100%{transform:translate(0) rotate(15deg)}}@keyframes closeTrash{100%{transform:translateY(50px)}50%{transform:translateY(0)}0%{transform:translate(0) rotate(15deg)}}quick-note-tag{font-size:10px}`,t([Ct({hasChanged:(t,e)=>null!=t&&void 0===e||t._id!=e._id||t._rev!=e._rev})],de.prototype,"note",void 0),customElements.define("quick-note-item",de);class ce extends it{constructor(){super(...arguments),this.closeable=!1,this.open=!1,this.backdrop=!1}firstUpdated(){this._watchEscape=this._watchEscape.bind(this)}render(){return j` <div class="dialog" role="dialog" aria-labelledby="title" aria-describedby="content"> <div class="titlebar"> <slot name="heading"></slot> <button ?hidden="${!this.closeable}" class="close" aria-label="Close" @click="${this.close}">✖️</button> </div> <div id="content" class="content"> <slot></slot> </div> </div> `}updated(t){this.closeable&&(this.open?document.addEventListener("keydown",this._watchEscape):document.removeEventListener("keydown",this._watchEscape))}close(){this.open=!1;const t=new CustomEvent("dialog-closed");this.dispatchEvent(t)}_watchEscape(t){"Escape"===t.key&&this.close()}}ce.styles=r`:host{position:fixed}:host(:not([backdrop])){left:50%;top:50%;transform:translateX(-50%) translateY(-50%)}:host([backdrop]){height:100vh;width:100vw;display:flex;color:#000;background:rgb(160 160 160 / 68%);backdrop-filter:blur(2px)}:host(:not([open])){display:none}.dialog{background:#dcdcdc;padding:15px;margin:auto}.titlebar{display:flex}.close{margin-left:auto}.dialog{box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);transition:all .3s cubic-bezier(.25,.8,.25,1)}.dialog:hover{box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22)}`,t([Et()],ce.prototype,"_wasFocused",void 0),t([Ct({type:Boolean,reflect:!0,attribute:"closeable"})],ce.prototype,"closeable",void 0),t([Ct({type:Boolean,reflect:!0,attribute:"open"})],ce.prototype,"open",void 0),t([Ct({type:Boolean,reflect:!0})],ce.prototype,"backdrop",void 0),customElements.define("quick-note-dialog",ce);class ue extends it{buildQuery(t){if((" "===t.data||"change"===t.type)&&-1!=this.textInputField.value.indexOf(":")){const t=this.textInputField.value,e=t.indexOf(":");if(0==t.substring(e+1).trim().length);else{let i=e-1;for(;" "==t.charAt(i);)i--;i=t.substring(0,i).lastIndexOf(" ");const s={key:t.substring(i,e).trim(),value:t.substring(e+1).trim()};this.textInputField.value=t.substring(0,i);const o=document.createElement("quick-note-tag");o.key=s.key,o.value=s.value,o.deletable=!0,o.slot="tags",o.addEventListener("delete",(()=>{o.remove()})),this.appendChild(o)}}}buildJsonQuery(){const t=this.textInputField.value.trim(),e=[],i={selector:{}},s=this.tags.filter((t=>-1==["title","author","content","createat"].indexOf(t.key))),o=this.tags.filter((t=>"title"===t.key.toLowerCase())).map((t=>t.value)),n=this.tags.filter((t=>"author"===t.key.toLowerCase())).map((t=>t.value)),r=this.tags.filter((t=>"content"===t.key.toLowerCase())).map((t=>t.value));this.tags.filter((t=>"createdat"===t.key.toLowerCase())).map((t=>t.value));let a={};o.length>1?a={$or:o.map((t=>({title:{$regex:`(?i).*${t}.*`}})))}:1==o.length?a={title:{$regex:`(?i).*${o[0]}.*`}}:e.push("title");let l={};n.length>1?l={$or:n.map((t=>({author:{$regex:`(?i).*${t}.*`}})))}:1==n.length?l={author:{$regex:`(?i).*${n[0]}.*`}}:e.push("author");let h={};r.length>1?h={$or:r.map((t=>({content:{$regex:`(?i).*${t}.*`}})))}:1==r.length?h={content:{$regex:`(?i).*${r[0]}.*`}}:e.push("content");let d={$or:[]};if(t.length>0&&e.forEach((e=>{d.$or.push({[e]:{$regex:`(?i).*${t}.*`}})})),i.selector.$and=[],Object.keys(h).length>0&&i.selector.$and.push(h),Object.keys(l).length>0&&i.selector.$and.push(l),Object.keys(a).length>0&&i.selector.$and.push(a),Object.keys(d).length>0&&i.selector.$and.push(d),s.length>0){const t=s.reduce(((t,e)=>(t.value={$regex:"(?i).*"+e.value+".*"},t.key={$regex:"(?i).*"+e.key+".*"},t)),{});i.selector.$and.push({labels:{$elemMatch:t}})}return console.log(JSON.stringify(i)),i}clearSearch(){this.innerHTML="",this.textInputField.value="",this.dispatchEvent(new CustomEvent("search",{detail:this.buildJsonQuery()}))}render(){const t=0!=this.tags.length;return j` <div class="main-container"> <div class="tag-container"> <slot name="tags"> </slot> </div> <input type="text" @input="${this.buildQuery}" @change="${this.buildQuery}" @keyup="${t=>{"Enter"===t.key&&this.dispatchEvent(new CustomEvent("search",{detail:this.buildJsonQuery()}))}}" ?padded="${t}" placeholder="search"> <button class="clear" @click="${this.clearSearch}">Clear</button> <button class="search" @click="${()=>this.dispatchEvent(new CustomEvent("search",{detail:this.buildJsonQuery()}))}">Search</button> <div> </div></div>`}}function pe(t,e,i){return Math.min(Math.max(t,i),e)}ue.styles=r`:host{--size:48px;padding:5px;min-height:var(--size)}.main-container{background:#fff;border-radius:calc(var(--size)/ 2);border:1px solid #d3d3d3;height:100%;box-sizing:border-box;display:flex}.main-container input{height:100%;border:0;box-sizing:border-box;flex:1}.main-container input[padded]{margin-left:calc(var(--size)/ 2)}.search{border-radius:0 calc(var(--size)/2) calc(var(--size)/2) 0;border:1px solid #d3d3d3}input[type=text]{outline:0;background:0 0}:host(:focus-within) .main-container{outline:2px solid #add8e6}.tag-container{display:flex;align-items:center;margin-left:5px;gap:3px}.search{border:0;border-left:1px solid #d3d3d3}.clear{border:0;border-left:1px solid #d3d3d3}`,t([St('input[type="text"')],ue.prototype,"textInputField",void 0),t([St("button.search")],ue.prototype,"searchButton",void 0),t([function(t){const{slot:e,selector:i}=null!=t?t:{};return At({descriptor:s=>({get(){var s;const o="slot"+(e?`[name=${e}]`:":not([name])"),n=null===(s=this.renderRoot)||void 0===s?void 0:s.querySelector(o),r=null!=n?Lt(n,t):[];return i?r.filter((t=>t.matches(i))):r},enumerable:!0,configurable:!0})})}({slot:"tags",selector:"quick-note-tag"})],ue.prototype,"tags",void 0),customElements.define("quick-note-search-bar",ue);class ge extends Error{constructor(t){super(`Failed to parse color: "${t}"`)}}var ve=ge;function _e(t){if("string"!=typeof t)throw new ve(t);if("transparent"===t.trim().toLowerCase())return[0,0,0,0];let e=t.trim();e=ke.test(t)?function(t){const e=t.toLowerCase().trim(),i=fe[function(t){let e=5381,i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return(e>>>0)%2341}(e)];if(!i)throw new ve(t);return`#${i}`}(t):t;const i=be.exec(e);if(i){const t=Array.from(i).slice(1);return[...t.slice(0,3).map((t=>parseInt(ye(t,2),16))),parseInt(ye(t[3]||"f",2),16)/255]}const s=we.exec(e);if(s){const t=Array.from(s).slice(1);return[...t.slice(0,3).map((t=>parseInt(t,16))),parseInt(t[3]||"ff",16)/255]}const o=$e.exec(e);if(o){const t=Array.from(o).slice(1);return[...t.slice(0,3).map((t=>parseInt(t,10))),parseFloat(t[3]||"1")]}const n=xe.exec(e);if(n){const[e,i,s,o]=Array.from(n).slice(1).map(parseFloat);if(pe(0,100,i)!==i)throw new ve(t);if(pe(0,100,s)!==s)throw new ve(t);return[...Ee(e,i,s),o||1]}throw new ve(t)}const me=t=>parseInt(t.replace(/_/g,""),36),fe="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce(((t,e)=>{const i=me(e.substring(0,3)),s=me(e.substring(3)).toString(16);let o="";for(let t=0;t<6-s.length;t++)o+="0";return t[i]=`${o}${s}`,t}),{});const ye=(t,e)=>Array.from(Array(e)).map((()=>t)).join(""),be=new RegExp(`^#${ye("([a-f0-9])",3)}([a-f0-9])?$`,"i"),we=new RegExp(`^#${ye("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),$e=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${ye(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),xe=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ke=/^[a-z]+$/i,Ce=t=>Math.round(255*t),Ee=(t,e,i)=>{let s=i/100;if(0===e)return[s,s,s].map(Ce);const o=(t%360+360)%360/60,n=(1-Math.abs(2*s-1))*(e/100),r=n*(1-Math.abs(o%2-1));let a=0,l=0,h=0;o>=0&&o<1?(a=n,l=r):o>=1&&o<2?(a=r,l=n):o>=2&&o<3?(l=n,h=r):o>=3&&o<4?(l=r,h=n):o>=4&&o<5?(a=r,h=n):o>=5&&o<6&&(a=n,h=r);const d=s-n/2;return[a+d,l+d,h+d].map(Ce)};function Ae(t,e){const[i,s,o,n]=function(t){const[e,i,s,o]=_e(t).map(((t,e)=>3===e?t:t/255)),n=Math.max(e,i,s),r=Math.min(e,i,s),a=(n+r)/2;if(n===r)return[0,0,a,o];const l=n-r;return[60*(e===n?(i-s)/l+(i<s?6:0):i===n?(s-e)/l+2:(e-i)/l+4),a>.5?l/(2-n-r):l/(n+r),a,o]}(t);return function(t,e,i,s){return`hsla(${(t%360).toFixed()}, ${pe(0,100,100*e).toFixed()}%, ${pe(0,100,100*i).toFixed()}%, ${parseFloat(pe(0,1,s).toFixed(3))})`}(i,s,o-e,n)}class Se extends it{constructor(){super(...arguments),this.deletable=!1,this.color="#444444"}render(){const t=this.color||"lightgray",e=Ae(t,.2);let i="#DDDDDD";return function(t){if("transparent"===t)return 0;function e(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}const[i,s,o]=_e(t);return.2126*e(i)+.7152*e(s)+.0722*e(o)}(t)>.5&&(i="#333333"),j` <style>:host{background:${t};border:1px solid ${e};color:${i}}button{background:${t};color:${i}}</style> <div class="key">${this.key}:</div><div class="value">${this.value}</div><button ?hidden="${!1===this.deletable}" @click="${()=>this.dispatchEvent(new CustomEvent("delete",{detail:{target:this}}))}">x</button> `}}Se.styles=r`:host{border-radius:15px;height:auto;overflow:hidden;box-sizing:border-box;display:inline-flex}button{box-sizing:border-box;border:0;border-left:1px solid;margin:2px 0 2px 0;cursor:pointer}.key,.value{padding-top:5px;padding-bottom:5px}.key{padding-left:5px}.value{text-indent:.5em;padding-right:5px}`,t([Ct()],Se.prototype,"key",void 0),t([Ct()],Se.prototype,"value",void 0),t([Ct({reflect:!0,attribute:"deletable"})],Se.prototype,"deletable",void 0),t([Ct()],Se.prototype,"color",void 0),customElements.define("quick-note-tag",Se);const Te=Intl.NumberFormat(navigator.language,{notation:"compact",style:"unit",unit:"byte",unitDisplay:"narrow"});class Le extends it{constructor(){super(...arguments),this.title=""}onDeleteClick(t){t.preventDefault(),t.stopPropagation(),this.dispatchEvent(new CustomEvent("delete",{detail:this.title}))}render(){return j` <div class="container"> <div class="removeIcon" @click="${this.onDeleteClick}">x</div> <i>${Te.format(this.attachment.length)}</i> <i class="fa-solid fa-user"></i> <img src="${""}${function(t){const e={image:"fa-file-image-o",audio:"fa-file-audio-o",video:"fa-file-video-o","application/pdf":"fa-file-pdf-o","application/msword":"fa-file-word-o","application/vnd.ms-word":"fa-file-word-o","application/vnd.oasis.opendocument.text":"fa-file-word-o","application/vnd.openxmlformats-officedocument.wordprocessingml":"fa-file-word-o","application/vnd.ms-excel":"fa-file-excel-o","application/vnd.openxmlformats-officedocument.spreadsheetml":"fa-file-excel-o","application/vnd.oasis.opendocument.spreadsheet":"fa-file-excel-o","application/vnd.ms-powerpoint":"fa-file-powerpoint-o","application/vnd.openxmlformats-officedocument.presentationml":"fa-file-powerpoint-o","application/vnd.oasis.opendocument.presentation":"fa-file-powerpoint-o","text/plain":"fa-file-text-o","text/html":"fa-file-code-o","application/json":"fa-file-code-o","application/gzip":"fa-file-archive-o","application/zip":"fa-file-archive-o"};for(var i in e){if(!e.hasOwnProperty(i))return"fa-file-o";if(0===t.search(i))return e[i]}}(this.attachment.content_type)}.png"> <h1>${this.title}</h1> </div> `}}Le.styles=r`:host{height:var(--size,256px);width:var(--size,256px);padding:5px}.container{border:2px dashed #d3d3d3;border-radius:5px;position:relative;display:flex;flex-direction:column;align-items:center;min-height:100%}.removeIcon{position:absolute;top:0;right:0;width:25px;height:25px;border-radius:0 5px 0 0;border:1px solid #d00;background:red;line-height:22px;cursor:pointer}h1{word-break:break-word}`,t([Ct()],Le.prototype,"title",void 0),t([Ct()],Le.prototype,"attachment",void 0),customElements.define("quick-note-attachment",Le),new URL(new URL("e922fec3.svg",import.meta.url).href,import.meta.url).href,new URL(new URL("fe17fb7c.svg",import.meta.url).href,import.meta.url).href;class De extends it{constructor(){super(...arguments),this.editable=!1,this.hidden=!1,this.saveEnabled=!1,this.noteTitle="",this.content="",this.labels=[],this._attachments=new Map,this.labelsLength=-1,this.attachmentsNeedToBeSaved=!1}set note(t){this._note=t,this.attachmentsNeedToBeSaved=!1,this.saveEnabled=!1,null==t?(this.noteTitle="",this.content="",this.labels=[],this._attachments=new Map,this.createdAt=new Date,this.author=""):(this.noteTitle=t.title,this.content=t.content,this.labels=[...t.labels],this._attachments=new Map(t._attachments),this.author=t.author,this.createdAt=t.createdAt,this.requestUpdate(),this.inputTitle&&this.inputTitle.focus())}get note(){return this._note}onDataChanged(t){let e=t.target;this[e.getAttribute("data-attribute")||""]=e.value,this.checkSaveEnabled()}handleEscapeKeyboard(t){if("Escape"===t.key){let e=t.target;const i=e.getAttribute("data-attribute")||"";e.value=this[i]}}setValue(t){let e=t.target;this[e.getAttribute("data-attribute")||""]=e.value}attributeChangedCallback(t,e,i){"hidden"!==t||this.hidden||this.shadowRoot&&this.inputTitle&&this.inputTitle.focus()}resetLabels(){this.labels=this.note.labels,this.checkSaveEnabled()}resetAttachments(){this._attachments=this.note._attachments,this.checkSaveEnabled()}onSave(){const t=!this.labelsNeedToBeSaved()&&!this.titleNeedsToBeSaved()&&!this.contentNeedsToBeSave()&&this.attachmentsNeedToBeSaved;this.note.title=this.noteTitle,this.note.author=this.author,this.note.content=this.content,this.note.labels=this.labels,this.note._attachments.forEach(((t,e)=>{-1==[...this._attachments.keys()].indexOf(e)&&(this.note._attachments.get(e).length=-1)}));for(const t of this._attachments.entries())this.note._attachments.set(t[0],t[1]);this.dispatchEvent(new CustomEvent("save",{detail:{note:this.note,onlyAttachment:t}}))}labelsNeedToBeSaved(){return this.labels.some((t=>this.note.labels.every((e=>e.key.toLowerCase()!==t.key.toLowerCase()||e.value.toLowerCase()!==t.value.toLowerCase()))))&&this.note.labels.some((t=>this.labels.every((e=>t.key.toLowerCase()!==e.key.toLowerCase()&&t.value.toLowerCase()!==e.value.toLowerCase()))))||this.labels.length!=this.note.labels.length}titleNeedsToBeSaved(){return this.note.title!==this.noteTitle}contentNeedsToBeSave(){return this.note.content!==this.content}checkSaveEnabled(){this.saveEnabled=this.titleNeedsToBeSaved()||this.contentNeedsToBeSave()||this.labelsNeedToBeSaved()||this.attachmentsNeedToBeSaved;
//!attachmentsAreEquals;
}addLabel(){""!==this.newTagKey.value&&""!==this.newTagValue.value&&(this.labels=[...this.labels,{key:this.newTagKey.value,value:this.newTagValue.value}],this.newTagKey.value="",this.newTagValue.value="",this.checkSaveEnabled())}deleteLabel(t){this.labels=this.labels.filter(((e,i)=>i!==t)),this.checkSaveEnabled()}deleteAttachment(t){this._attachments.delete(t),this.attachmentsNeedToBeSaved=!0,this.checkSaveEnabled(),this.requestUpdate()}askForAttachmentDownload(t){this.dispatchEvent(new CustomEvent("download",{detail:{doc:this.note,attachment:t}}))}async handleOnDrop(t){var e;t.preventDefault(),t.stopPropagation(),this.unhighlightDnD(t),Array.from((null===(e=t.dataTransfer)||void 0===e?void 0:e.items)||[]).forEach((t=>{if("file"!==t.kind)return;const e=t.getAsFile();this._attachments.set(e.name,{length:e.size||-1,revPos:-1,content_type:e.type||"",digest:"",data:e})})),this.attachmentsNeedToBeSaved=!0,this.checkSaveEnabled(),this.requestUpdate()}async highlightDnD(t){t.preventDefault(),t.stopPropagation(),this.dropZone.classList.add("highlight")}async unhighlightDnD(t){t.preventDefault(),t.stopPropagation(),this.dropZone.classList.remove("highlight")}async handleOnDragOver(t){t.preventDefault(),t.stopPropagation(),this.dropZone.classList.add("highlight")}render(){let t=this._attachments;null==t&&(t=new Map);let e=[...t.keys()];return j`
        <header>
            <button class="returnButton" @click="${()=>this.dispatchEvent(new CustomEvent("return"))}">${ie}</button>
            <input autofocus class="inputTitle" data-attribute="noteTitle" @keydown=${this.handleEscapeKeyboard} @input=${this.onDataChanged} @change="${this.setValue}" type="text" .value="${this.noteTitle}"/>
            
            <button class="save" @click=${this.onSave} ?hidden=${!this.saveEnabled}>
                ${Jt}
            </button>
        </header>
        <h2>Tags</h2>
        <div class="tags">
        ${this.labels.map(((t,e)=>j`<quick-note-tag .key="${t.key}" .value="${t.value}" deletable @delete="${()=>this.deleteLabel(e)}"></quick-note-tag>`))}
        <i ?hidden=${0!=this.labels.length}>No tags defined</i>
        <div class="newTag">
            <span><input type="text" class="key" placeholder="label"></span>
            <span>:</span>
            <span><input type="text" class="value" placeholder="value"></span>
        </div>
        <button class="add tag" @click=${this.addLabel}>+</button>
        <button class="refresh tag" @click=${this.resetLabels}>
            ${te}
        </button>
        </div>

        <h2>Content</h2>
        <!--
        <tinymce-editor 
            menubar="false"
            plugins="advlist autolink lists link image charmap print preview anchor searchreplace visualblocks code fullscreen insertdatetime media table paste code help wordcount" 
            toolbar="undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help"        
            @keydown=${this.handleEscapeKeyboard} 
            @change="${this.setValue}" 
            @input=${this.onDataChanged} 
            data-attribute="content" 
            class="content" 
            api-key="no-api-key" .content="${this.content}"></tinymce-editor>
        -->

        <textarea @keydown=${this.handleEscapeKeyboard} @change="${this.setValue}" @input=${this.onDataChanged} data-attribute="content" class="content" .value="${this.content}"></textarea>

        <h2>Attachments</h2>
        <div class="attachments" @dragenter=${this.highlightDnD} @dragover=${this.highlightDnD} @dragleave=${this.unhighlightDnD} @drop=${this.handleOnDrop}>
            <i ?hidden=${0!=e.length}>No attachments defined</i>
            ${e.map((t=>{var e;return j` <quick-note-attachment .title="${t}" .attachment="${null===(e=this._attachments)||void 0===e?void 0:e.get(t)}" @delete="${()=>this.deleteAttachment(t)}" @click="${()=>this.askForAttachmentDownload(t)}"> </quick-note-attachment>`}))}
            <button class="add attachment">+</button>
            <button class="refresh attachment" @click=${this.resetAttachments}>
                ${te}
            </button>
        </div>
        <i>Created by ${this.author} - ${this.createdAt.toLocaleDateString(navigator.language,oe)}</i>
    `}}De.styles=[r`:host{padding:10px;display:flex;flex-direction:column;flex:1;gap:5px}header{flex:1;display:flex;gap:5px;max-height:64px}header .returnButton{margin-top:auto;margin-bottom:auto;border-radius:50%;background:#d3d3d3;border:0;padding:10px;aspect-ratio:1;margin-left:10px;margin-right:10px}header .returnButton:hover{background:#ababab}h2{text-align:left;display:none}.tags{display:flex;gap:5px}.tags quick-note-tag{margin-top:auto;margin-bottom:auto}.attachments{display:flex;gap:5px;min-height:64px;background:rgba(220,220,220,00.2);border:2px dashed gray}button{aspect-ratio:1/1;outline:0;border:1px solid transparent;box-shadow:0 0 9px 4px rgb(0 0 0 / 40%)}button.save{margin-left:5px;margin-top:auto;margin-bottom:auto;padding:10px;border:0;background-color:var(--active-action-color);border-radius:50%;color:#fff}button.save svg{margin:auto}.content{flex:1}.inputTitle{flex:1;font-size:larger;background:0 0;border:0;margin-top:auto;margin-bottom:auto;padding-top:5px;padding-bottom:5px;background:0 0;border-color:transparent}.inputTitle:focus{border:0;text-shadow:2px 2px 7px #000000a6;font-style:italic}header .inputTitle:not(:focus){border-bottom:1px solid gray}.attachments i,.tags i{margin-top:auto;margin-bottom:auto;margin-right:5px}.tags .newTag{border-radius:12px;border:1px solid #d3d3d3;background:#fff;color:#000;display:flex;margin-top:auto;margin-bottom:auto;margin-left:auto;height:24px}.tags .newTag span:first-of-type{padding-left:10px}.tags .newTag span:last-of-type{padding-right:10px}.tags .newTag:focus-within{border:1px solid #ff0}.tags .newTag input{background:0 0;border:0;outline:0}.attachments{align-items:center;justify-content:center}.attachments.highlight{background:#007e1e2e}quick-note-attachment:hover{cursor:pointer}button.refresh.attachment,button.refresh.tag{aspect-ratio:1/1;margin-top:auto;margin-bottom:auto;border:1px solid #494949;border-radius:50%;line-height:32px;font-size:32px;color:#fff;width:32px;height:32px;outline:0;background-color:gray;padding:0;margin-right:5px;margin-left:5px}button.refresh svg{width:24px;height:24px;margin-right:2px}.add{border:1px solid #494949;border-radius:50%;line-height:32px;font-size:32px;color:#fff;width:32px;height:32px;outline:0;background-color:gray;margin-top:auto;margin-bottom:auto;margin-right:5px;margin-left:5px;padding:0}`],t([Ct({reflect:!0,attribute:"editable"})],De.prototype,"editable",void 0),t([Ct({reflect:!0,attribute:"hidden"})],De.prototype,"hidden",void 0),t([Et()],De.prototype,"_note",void 0),t([Et()],De.prototype,"saveEnabled",void 0),t([Et()],De.prototype,"noteTitle",void 0),t([Et()],De.prototype,"content",void 0),t([Et()],De.prototype,"labels",void 0),t([Et()],De.prototype,"_attachments",void 0),t([Et()],De.prototype,"author",void 0),t([Et()],De.prototype,"createdAt",void 0),t([St(".inputTitle")],De.prototype,"inputTitle",void 0),t([function(t){return At({descriptor:e=>({get(){var e,i;return null!==(i=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelectorAll(t))&&void 0!==i?i:[]},enumerable:!0,configurable:!0})})}("quick-note-tag")],De.prototype,"tags",void 0),t([Et()],De.prototype,"labelsLength",void 0),t([St(".tags .newTag input.key")],De.prototype,"newTagKey",void 0),t([St(".tags .newTag input.value")],De.prototype,"newTagValue",void 0),t([St("div.attachments")],De.prototype,"dropZone",void 0),customElements.define("quick-note-detail",De);const ze="fryeiskghfbreidjs";class Oe extends Error{constructor(t,e){super(t),this.error=e}}const Ne=new Oe("No database selected.",void 0),Me=new Oe("Not connected.",void 0);class je{constructor(t){this._username=t.username,this._password=t.password,this.server=t.server,this._userRoles=[],this._database=""}static async connect(t){let e;if("string"==typeof t){const i=await fetch(`${t}/_session`,{headers:{"Content-Type":"application/json"},method:"GET"});if(!i||200!=i.status)throw new Oe(`Error during connect to ${t}`,i);const s=await i.json(),o=s.userCtx.name;if(null==o)return;return e=new je({server:t,username:o,password:""}),e._userRoles=[...s.userCtx.roles],e}return e=new je({server:t.server,username:t.username,password:t.password}),await e.reconnect(),e}get username(){return this._username}get userRoles(){return this._userRoles}async setPassword(t){const e=this._password;this._password=t;try{this.reconnect()}catch(t){throw this._password=e,t}}async isConnected(){const t=await fetch(`${this.server}/_session`);return t&&200==t.status&&!0===(await t.json()).ok}async getDatabases(){if(!this.isConnected())throw Me;const t=await fetch(`${this.server}/_all_dbs`,{headers:{"Content-Type":"application/json"},credentials:"include"});if(!t||200!=t.status)throw new Oe("Error during fetching databases",t);return await t.json()}get currentDatabase(){return this._database}async newDatabase(t){if(!this.isConnected())throw Me;const e=await fetch(`${this.server}/${t}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT"});if(!e||201!=e.status&&202!=e.status)throw new Oe(`Error during new database ${t}`,e);return"true"===(await e.json()).ok}async deleteDatabase(t){if(!this.isConnected())throw Me;const e=await fetch(`${this.server}/${t}`,{headers:{"Content-Type":"application/json"},credentials:"include",method:"DELETE"});if(!e||200!=e.status&&202!=e.status)throw new Oe(`Error during delete database ${t}`,e);return"true"===(await e.json()).ok}async useDatabase(t){if(!this.isConnected())throw Me;if(""===t)return;const e=await fetch(`${this.server}/${t}`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(!e||200!=e.status)throw new Oe(`Error during use database ${t}`,e);this._database=t}async getAllDocuments(){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;const t=await fetch(`${this.server}/${this._database}/_all_docs?include_docs=true`,{credentials:"include",headers:{"Content-Type":"application/json"}});if(!t||200!=t.status)throw new Oe("Error during get all documents",t);return(await t.json()).rows.map((t=>t.doc))}async getDocuments(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;const e=await fetch(`${this.server}/${this._database}/_find`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!e||200!=e.status)throw new Oe("Error during get documents",e);return await e.json()}async getDocument(t,e,i=!1){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;const s=new URLSearchParams;e&&s.append("rev",e),void 0!==i&&s.append("attachments",""+i);const o=await fetch(`${this.server}/${this._database}/${t}?${s.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!o||200!=o.status&&304!=o.status)throw new Oe(`Error during get document id: ${t} / rev: ${e} / with_attachments:${i}`,o);return await o.json()}async updateDocument(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;return await(await fetch(`${this.server}/${this._database}/${t._id}?_rev=${t._rev}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json()}async deleteDocument(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;return await(await fetch(`${this.server}/${this._database}/${t._id}?rev=${t._rev}`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include"})).json()}async newDocument(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;void 0===t._id&&(t._id=await this.getUUIDs());const e=await(await fetch(`${this.server}/${this._database}/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})).json();return t._rev=e.rev,e}async getUUIDs(t=1){if(!this.isConnected())throw Me;const e=await(await fetch(`${this.server}/_uuids?count=${t}`,{headers:{"Content-Type":"application/json"},credentials:"include"})).json();return 1==t?e.uuids[0]:e.uuids}async reconnect(){if(""===this._password)throw Error("Unable to reconnect as we don't know the password");const t=await fetch(`${this.server}/_session`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this._password})});if(!t||200!=t.status)throw new Oe(`Error during connection to ${this.server}`,t);const e=await t.json();this._userRoles=[...e.roles],localStorage.setItem(ze,atob(this.username)),""!==this._database&&void 0!==this._database&&null!==this._database&&await this.useDatabase(this._database)}async disconnect(){await fetch(`${this.server}/_session`,{method:"DELETE",credentials:"include"}),localStorage.removeItem(ze)}async deleteAttachment(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;const e=await fetch(`${this.server}/${this._database}/${t.documentId}/${t.fileName}?rev=${t.rev}`,{method:"DELETE",credentials:"include"});if(!e||200!=e.status&&202!=e.status)throw new Oe(`Error during delete attachment doc id: ${t.documentId} / rev: ${t.rev} / filename: ${t.fileName}`,e);return await e.json()}async uploadAttachment(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;const e=t.file.name,i=await fetch(`${this.server}/${this._database}/${t.documentId}/${e}?rev=${t.rev}`,{method:"PUT",credentials:"include",headers:{"Content-Type":t.file.type},body:t.file});if(!i||201!=i.status&&202!=i.status)throw new Oe(`Error during uploading attachment doc id: ${t.documentId} / rev: ${t.rev} / filename: ${e}`,i);return await i.json()}async downloadAttachment(t){if(!this.isConnected())throw Me;if(""===this._database)throw Ne;const e=await fetch(`${this.server}/${this._database}/${t.documentId}/${t.attachment}?_rev=${t.rev}`,{method:"GET",credentials:"include"});if(!e||200!=e.status)throw new Oe(`Error during uploading attachment doc id: ${t.documentId} / rev: ${t.rev} / filename: ${t.attachment}`,e);return e}async getRevisions(t){const e=await(await fetch(`${this.server}/${this._database}/${t}?revs=true`)).json();return e._revisions.ids.map(((t,i)=>e._revisions.start-i+t))}}class Ie extends it{constructor(){super(...arguments),this.title="Quick notes",this.notes=[],this.menuOpened=!1,this.loggedIn=!1,this.username="",this.fetchingNotes=!1}askForDeleteNote(t){this.confirmDeleteDialog.open=!0,this.noteToDelete=t}async _deleteNote(){var t;if(void 0===this.noteToDelete)return;const e=await(null===(t=this._couchDB)||void 0===t?void 0:t.deleteDocument(this.noteToDelete));e&&e.ok&&!0===e.ok&&(this.notes=this.notes.filter((t=>{var e,i;return t._id!==(null===(e=this.noteToDelete)||void 0===e?void 0:e._id)&&t._rev!==(null===(i=this.noteToDelete)||void 0===i?void 0:i._rev)})),this.noteToDelete=void 0)}createNote(){this.selected={_id:void 0,_rev:void 0,title:"",author:this.username,createdAt:new Date,content:"",labels:[],_attachments:new Map}}showMenu(){this.menuOpened=!0}async connectedCallback(){super.connectedCallback();try{if(this._couchDB=await je.connect("/api"),void 0===this._couchDB||void 0===this._couchDB.username||""===this._couchDB.username)return;await this._couchDB.useDatabase("userdb-"+ne(this._couchDB.username)),this.loggedIn=!0,this.username=this._couchDB.username,setTimeout((()=>{var t;(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("button.createNewNote")).focus()}),0),this.fetchNotes()}catch(t){t&&t.error.status>=500&&(this.loggedIn=!1,this.loginMessage="Service unavailable. Please contact the administrator")}}async login(t){t.preventDefault();const e=new FormData(this.loginForm),i=e.get("username"),s=e.get("password");try{if(this._couchDB=await je.connect({server:"/api",username:i,password:s}),null==this._couchDB)return this.loggedIn=!1,void(this.loginMessage="Incorrect credentials");try{await this._couchDB.useDatabase("userdb-"+ne(i)),this.loggedIn=!0,this.loginMessage=void 0,this.username=i,this.fetchNotes()}catch(t){console.log(t)}}catch(t){const e=t;this.loggedIn=!1,401==e.error.status?this.loginMessage="Access unauthorized":this.loginMessage=e.message}return!1}handleError(t){}async fetchNotes(t){var e;setTimeout((()=>this.fetchingNotes=!0),0),void 0!==t&&void 0!==t.selector||(t={selector:{}});try{const i=await(null===(e=this._couchDB)||void 0===e?void 0:e.getDocuments(t));this.notes=function(t){return t.map((t=>ae(t))).filter((t=>void 0!==t))}(i.docs),this.fetchingNotes=!1}catch(t){this.handleError(t)}}async _saveNote(t,e){var i,s,o,n,r;const a={...re(t)},l={_id:t._id,_rev:t._rev};let h,d;void 0===t._id?(h=await(null===(i=this._couchDB)||void 0===i?void 0:i.newDocument(a)),l._id=h.id,l._rev=h.rev,d=!0):(e||(h=await(null===(s=this._couchDB)||void 0===s?void 0:s.updateDocument(a)),l._rev=null==h?void 0:h.rev),d=!1);let c,u=!1;for(const e of[...t._attachments.entries()])if(-1==e[1].length){const t=await(null===(o=this._couchDB)||void 0===o?void 0:o.deleteAttachment({documentId:l._id,rev:l._rev,fileName:e[0]}));if(!t||!0!==t.ok){u=!0;break}l._rev=t.rev}else if(""===e[1].digest){const t=await(null===(n=this._couchDB)||void 0===n?void 0:n.uploadAttachment({documentId:l._id,rev:l._rev,file:e[1].data}));if(!t||!0!==t.ok){u=!0;break}l._rev=t.rev}if(u)console.log("muse revert to previous revision");else{try{c=ae(await(null===(r=this._couchDB)||void 0===r?void 0:r.getDocument(l._id,l._rev)))}catch(t){return void this.showToaster(j`An error happened. Click <a @click="${this.fetchNotes}">here</a> to refresh`)}if(void 0!==c){if(d)this.notes.push(c);else{const e=this.notes.findIndex((e=>e._id===t._id&&e._rev===t._rev));this.notes.splice(e,1,c)}this.requestUpdate(),this.selected=void 0}}}showToaster(t){}async downloadAttachment(t){var e;const i=await(null===(e=this._couchDB)||void 0===e?void 0:e.downloadAttachment({documentId:t.detail.doc._id,rev:t.detail.doc._rev,attachment:t.detail.attachment})),s=window.URL.createObjectURL(await i.blob()),o=document.createElement("a");o.href=s,o.download=t.detail.attachment,o.click(),window.URL.revokeObjectURL(s)}async logout(){var t;await(null===(t=this._couchDB)||void 0===t?void 0:t.disconnect()),this.loggedIn=!1}selectDatabase(){var t,e;const i=(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector("select#selectDatabase")).value;null===(e=this._couchDB)||void 0===e||e.useDatabase(i)}render(){var t,e,i;return j`
      <header>
        <div class="logo">${ee}
        </div>
        <h1 >${this.title}</h1>
        <button class="spaceMe createNewNote" ?hidden=${!this.loggedIn} @click=${this.createNote}>+</button>
        <button class="spaceMe logout" ?hidden=${!this.loggedIn} @click=${this.logout}>${se}</button>
      </header>
      <main>

        <!-- LOGIN DIALOG -->
        <div class="login boxShadow" ?hidden=${this.loggedIn}>
          <h2><i>Welcome in Quick Notes</i></h2>
          <form @submit=${this.login} >
            <input type="text" placeholder="Username" name="username" id="username"/>
            <input type="password" placeholder="Password" name="password" id="password"/>
            <input type="submit" value="Login"/>
            <div ?hidden=${void 0===this.loginMessage} class="loginMessage">${this.loginMessage}</div>
          </form>
        </div>
        <!-- END OF LOGIN DIALOG -->

        <!-- DETAIL OF A NOTE -->
        <quick-note-detail 
            id="details" 
            ?hidden=${!this.selected||!this.loggedIn}
            .note=${this.selected}
            @return="${()=>this.selected=void 0}"
            @save="${t=>this._saveNote(t.detail.note,t.detail.onlyAttachment)}"
            @download="${this.downloadAttachment}"
        ></quick-note-detail>
        <!-- END OF DETAIL OF A NOTE -->

        <!-- LIST OF NOTES -->
        <div ?hidden=${void 0!==this.selected||!this.loggedIn} id="list">
          <quick-note-search-bar @search="${t=>this.fetchNotes(t.detail)}"></quick-note-search-bar>
          <div ?hidden=${!this.fetchingNotes}>Fetching notes</div>
          <lit-virtualizer ?hidden=${this.fetchingNotes} id="list"
            scroller
            .items=${this.notes}
            .renderItem=${t=>j` <quick-note-item .note="${t}" @click="${()=>this.selected=t}" @delete="${e=>this.askForDeleteNote(t)}"> </quick-note-item>`}
          </lit-virtualizer>
          <!--
          ${this.notes.map((t=>j` <quick-note-item .note="${t}" @click="${()=>this.selected=t}" @delete="${e=>this.askForDeleteNote(t)}"> </quick-note-item> `))}-->
          <!-- END OF LIST OF NOTES -->


        </div>
      </main>
      <!-- SELECT DB DIALOG -->
      <quick-note-dialog id="selectDB" ?open="${this.loggedIn&&""===(null===(t=this._couchDB)||void 0===t?void 0:t.currentDatabase)}">
        <h2 slot="heading">Select a database</h2>
        <select id="selectDatabase" style="width: 100%">
        ${function(t,e,i){return t?e():null==i?void 0:i()}(""===(null===(e=this._couchDB)||void 0===e?void 0:e.currentDatabase),(()=>{var t;return xt(null===(t=this._couchDB)||void 0===t?void 0:t.getDatabases().then((t=>t.map((t=>j` <option value="${t}">${t}</option> `)))))}))}
        </select>
        <div style="display: flex; justify-content: flex-end; padding: 3px;">
          <button @click=${this.selectDatabase}>Select</button>
        </div>
        
      </quick-note-dialog>
      <!-- SELECT DB DIALOG -->

      <quick-note-dialog backdrop id="confirmDeleteDialog">
        <h2 slot="heading">Confirm deletion</h2>
        <p>Do you really want to delete note <i><u>${null===(i=this.selected)||void 0===i?void 0:i.title}</u></i> ?</p>
        <div style="display: flex; justify-content: flex-end; padding: 3px;">
          <button style="margin-right: 2px;" @click=${()=>{var t;null===(t=this.confirmDeleteDialog)||void 0===t||t.close(),this._deleteNote()}}>Yes</button>
          <button style="margin-left: 2px;" @click=${()=>{var t;return null===(t=this.confirmDeleteDialog)||void 0===t?void 0:t.close()}}>No</button>
        </div>
      </quick-note-dialog>
      <footer>
        Copyleft
      </footer>
    `}}Ie.styles=r`:host{--active-action-color:#00b912;min-height:100vh;display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start;margin:0 auto;text-align:center}main{flex-grow:1;display:flex;color:var(--theme-font-dark-color)}.logo svg{overflow:visible}.logo .pen{fill:var(--theme-primary-dark-color);animation:3s linear 0s infinite alternate animatePen;transform-origin:bottom right}@keyframes animatePen{0%{transform:translateX(-15px) rotate(0)}10%{transform:translateX(-14px) translateY(2px) rotate(2deg)}20%{transform:translateX(-12px) translateY(-2px) rotate(-2deg)}30%{transform:translateX(-10px) translateY(2px) rotate(2deg)}40%{transform:translateX(-8px) translateY(-2px) rotate(-2deg)}50%{transform:translateX(-6px) translateY(2px) rotate(2deg)}60%{transform:translateX(-4px) translateY(-2px) rotate(-2deg)}70%{transform:translateX(-2px) translateY(2px) rotate(2deg)}80%{transform:translateX(0) translateY(-2px) rotate(-2deg)}90%{transform:translateX(2px) translateY(2px) rotate(2deg)}100%{transform:translateX(5px) rotate(0)}}@media (prefers-color-scheme:dark){:host{background-color:var(--theme-primary-light-color);color:var(--theme-font-dark-color)}header{background-color:var(--theme-primary-dark-color)}}@media (prefers-color-scheme:light){:host{background-color:var(--theme-secondary-light-color);color:var(--theme-font-light-color)}header{background-color:var(--theme-primary-light-color)}}header{display:flex;flex-direction:row;gap:5px;height:54px;align-items:center;padding:5px}header .logo,header .logo img{height:100%}header h1{margin:0;margin-right:auto}header h2{margin-left:5px}#list{flex:1;display:flex;flex-direction:column}#list list-virtualizer{flex:1}#list[hidden]{display:none}#details[hidden]{display:none}quick-note-item:hover{background-color:var(--active-action-color)}quick-note-item{border-top:1px solid gray}quick-note-item:last-of-type{border-bottom:1px solid gray}.boxShadow{box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22)}.login{margin:auto;background:#ddd;padding:20px;border-radius:5px;border:1px solid var(--theme-primary-dark-color)}.login .loginMessage,.login input{font-size:larger}.login{color:var(--theme-font-light-color)}.login form{display:flex;flex-direction:column;gap:10px}.login form input[type=submit]{margin-left:auto}.createNewNote{box-shadow:0 0 9px 4px rgb(0 0 0 / 40%);border:1px solid transparent;border-radius:50%;line-height:32px;font-size:32px;color:#fff;width:32px;height:32px;outline:0;padding:0;background-color:var(--active-action-color)}.createNewNote:focus{border:1px solid #006400}.logout{border:1px gray;border-radius:50%;aspect-ratio:1/1;width:32px;height:32px;padding:3px;box-shadow:0 0 9px 4px rgb(0 0 0 / 40%);margin-bottom:auto;margin-top:auto;margin-left:10px;margin-right:10px}.logout svg{height:100%;width:100%;aspect-ratio:1/1}`,t([Ct({type:String})],Ie.prototype,"title",void 0),t([Ct({type:Array})],Ie.prototype,"notes",void 0),t([Et()],Ie.prototype,"selected",void 0),t([St("#confirmDeleteDialog")],Ie.prototype,"confirmDeleteDialog",void 0),t([Et()],Ie.prototype,"menuOpened",void 0),t([Et()],Ie.prototype,"loggedIn",void 0),t([Et()],Ie.prototype,"loginMessage",void 0),t([Et()],Ie.prototype,"username",void 0),t([Et()],Ie.prototype,"fetchingNotes",void 0),t([St(".login form")],Ie.prototype,"loginForm",void 0),customElements.define("quick-note-app",Ie);
